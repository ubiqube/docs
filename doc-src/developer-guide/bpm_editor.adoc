= BPM Editor
:doctype: book
:imagesdir: ./resources/
ifdef::env-github,env-browser[:outfilesuffix: .adoc]
:toc: left
:toclevels: 4 
:source-highlighter: pygments

The BPM editor is a web based UI for designing BPM processes.

== BPM design

To create a new BPM from the developer portal, click on "+ Create" from the swimlane "BPM Library." 

You can also browse through the existing BPM by clicking on "See more."

image:images/developer_dashboard_bpm.png[width=600px]

NOTE: you need to select a sub-tenant to see the BPM.


== BPMN elements

The {product_name} BPM engine supports the following BPMN elements:

image:images/bpm_start_event.png[] the first element of the BPM process.

image:images/bpm_end_event.png[] indicates the end of the BPM process.

image:images/bpm_task.png[] an executable task that can run workflow processes.

image:images/bpm_gateway_event.png[] represents an exclusive decision gateway (or decision tree).

NOTE: Support for more elements will be provided in future link:../release_notes{outfilesuffix}[releases]

=== Parallel gateway

Gateways can also be used to model concurrency in a process. 

The most straightforward gateway to introduce concurrency in a process model is the Parallel Gateway, which allows forking into multiple paths of execution or joining multiple incoming paths of execution.

image:images/bpm_parallel_exec.png[width=600px]

The functionality of the parallel gateway is based on the incoming and outgoing sequence flow(s):

- fork: all outgoing sequence flows are followed in parallel, creating one concurrent execution for each sequence flow.
- join: all concurrent executions arriving at the parallel gateway wait at the gateway until an execution has arrived for each of the incoming sequence flows. Then the process continues past the joining gateway.

Note that a parallel gateway does not need to be ‘balanced’ (i.e., a matching number of incoming/outgoing sequence flows for corresponding parallel gateways). 
A parallel gateway will simply wait for all incoming sequence flows and create a concurrent path of execution for each outgoing sequence flow, not influenced by other constructs in the process model. So, the following process is legal in {product_name}:

image:images/bpm_parallel_exec_unbalanced.png[width=600px]

=== Decision gateway (XOR)

image:images/bpm_gateway.png[width=600px]

The XOR gateway will let you model a decision in the process.

When the execution arrives at this decision gateway, all outgoing sequence flows are evaluated in the order in which they have been defined. 
The sequence flow whose condition evaluates to ‘true’ is selected for continuing the process.

To configure the gateway, you need to select the outbound link from the gateway, choose the inbound task and configure the condition to trasition to the next BPM task.

image:images/bpm_gateway_config.png[width=600px]

==== Operator

Select `is` or `is not` as the logical operator

==== Status
Select one of `Failed`, `Warning` or `Success` which are related to the link:workflow_editor{outfilesuffix}#lifecycle[3 possible statuses of a process that finished it's execution].

==== Default flow
Click on the decision gateway ans select the default flow of the process when there is not suitable condition based on the result of the inbound task.

image:images/bpm_gateway_default_flow.png[width=600px]

== Design a BPM process

=== Create a new BPM

Click on "Create" to create a new BPM editor.

Use your mouse to add tasks and link them together.

NOTE: A BPM process must have a StartEvent and an EndEvent.

IMPORTANT: Only one executable BPM process can be specified in a BPM definition.

.Multiple process definition in a single BPM is not supported
image:images/bpm_multiple_process_definition.png[width=600px]

You can save your BPM at anytime and edit it later. When you save you BPM, you need to select a sub-tenant.

NOTE: A BPM is associated to a single sub-tenant.

=== Connecting workflows and processes

Select an executable task to see the list of workflows (based on the sub-tenant selected), then select a process and provide its input parameters.

image:images/bpm_edit.png[width=600px]

=== Execution flow control

By default, the BPM execution will stop whenever the associated workflow process execution fails but you may need to make sure that the BPM continues to execute despite the failure. This is typically the case when there is a decision gateway where execution is routed based on the status of the process execution.

To allow the BPM process to continue executing after a workflow process execution fails, you need to edit the BPM task and check "Continue on Failure."

image:images/bpm_task_control_flow.png[width=600px]

=== Execution tracking

The BPM engine will start executing the BPM tasks one by one and the status of the current workflow process execution will be updated live in the "LATEST EXECUTIONRESULT" view while the detail of the process execution will be displayed.

image:../../user-guide/resources/images/bpm_execution_tracking.png[width=600px]


