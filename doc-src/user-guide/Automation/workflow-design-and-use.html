<div class="documentation-content">

<div class="wiki-content" id="main-content">
  <h1 id="WorkflowDesignandUse-Workflow,WorkflowInstance,ProcessandTask"><span class="">Workflow, Workflow Instance, Process and Task </span></h1>
  <p>To be able to execute a process, simple or complex, some entities need to be created under the repository:</p>
  <ul>
    <li><strong>Workflow</strong>: a Workflow or a Workflow definition file contains the administrative information, processes and variables used. It is an XML file stored in the repository.</li>
    <li><strong>Workflow Instance</strong>: to actually use a Workflow, a process with the type "create" has to be executed. Doing so will create a new instance for the Workflow. Processes with type "update" or "delete" are available to call on a Workflow instance.</li>
    <li><strong>Process</strong>: a process is a series of tasks to execute. This is a simple text files containing all ordering tasks.</li>
    <li><strong>Task</strong>: a task is one action or step of a process. It is a PHP file.</li>
  </ul>
  <p> </p>
  <p><a class="image-popup-fit-width" href="">
        <img alt="Image" src="images/Workflow-Overview.png" width="800"/></a></p>
  <div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info">
    <p class="title">NOTE: To help understand the concept, here is how Workflow could compare to C++:</p>
    
    
  </div>
  <h1 id="WorkflowDesignandUse-Repositorystructure"><span class="">Repository structure </span></h1>
  <h2 id="WorkflowDesignandUse-Servicefolder"><span class="">Service folder </span></h2>
  <p>All Workflows are listed under the Workflow folder in the repository. As long as an entity (customer or operator) is able to view a Workflow (based on its role) it can use a Workflow.</p>
  <p>A user can define the visibility of a Workflow by putting it in specific sub-tree.</p>
  <p>If the Workflow is created in a folder at the root of the Workflow repository, the Workflow will be visible by all. In the same way, the Workflows' visibility can be restricted to customers or customers under operator using repository icons.</p>
  <p>Furthermore, the Workflows have to be attached to the customers in order to be used.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceRepository.png" width="800"/></a></p>
  <h1 id="WorkflowDesignandUse-Workflowconsole"><span class="">Workflow console </span></h1>
  <ul>
    <li>The service console allows management of all the services from one screen.</li>
    <li>The service console is available for the manager and customer. On the legacy portal, the item "Manage Services" is under the General menu. On the customer portal, this is a dedicated widget.</li>
  </ul>
  <h2 id="WorkflowDesignandUse-Accesstotheconsole"><span class="">Access to the console </span></h2>
  <h3 id="WorkflowDesignandUse-Customerportal"><span class="">Customer portal</span></h3>
  <p>On the customer portal, use the "SERVICES" tab to access to the services.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Servicesfromcustomer.png" width="800"/></a></p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Servicespage.png" width="800"/></a></p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Servicespage2.png" width="800"/></a></p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Servicespage3.png" width="800"/></a></p>
  <h2 id="WorkflowDesignandUse-Execution"><span class="">Execution </span></h2>
  <p>To execute a process, first select a Workflow or an instance of this Workflow. If you select the service itself, only the create processes will be available to use.</p>
  <ol>
    <li>Select the service of one instance of the service.</li>
    <li>Click on the process button.</li>
    <li>Fill variables for each tasks.</li>
    <li>Click "Run Now" to trigger new process execution.</li>
  </ol>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceExecution.png" width="800"/></a></p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceExecution1.png" width="800"/></a></p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceExecution2.png" width="800"/></a></p>
  <p>The process is running now.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceTaskExecution.png" width="800"/></a></p>
  <p>Using the <strong>Process Activity</strong> tab, it is possible to monitor the execution of the process and the current task. The execution starting date and the elapsed time are also displayed. Note that the current running task is displayed just below the corresponding process. The <strong>Service</strong> and <strong>Name</strong> columns are left empty for tasks.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceTaskExecution1.png" width="800"/></a></p>
  <p>Once done, the status of the process executed become green.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceTaskExecuted.png" width="800"/></a></p>
  <h2 id="WorkflowDesignandUse-SchedulingaProcess"><span class="">Scheduling a Process </span></h2>
  <p>Each process can be configured to allow scheduling independently.</p>



  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/OrchestrationScheduling01.png" width="800"/></a></p>
  <p>When a process can be scheduled a new button ("Schedule") appears when a process is launched.</p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/OrchestrationScheduling02.png" width="800"/></a></p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/OrchestrationScheduling03.png" width="800"/></a></p>
  <p>When the process is scheduled, it is displayed in the <strong>Process Activity</strong> tab.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Servicespage3.png" width="800"/></a></p>
  <p>Note that if a <strong>CREATE</strong> process is scheduled later, the corresponding service instance will only be created at the first execution of the process, so the scheduling will only be visible in the <strong>Process Activity</strong> tab, not in the <strong>Services</strong> tab before the first execution of the process. Note also that only one service instance is created even if the <strong>CREATE</strong> process is recurrent.</p>
  <h2 id="WorkflowDesignandUse-ProcessExecutionStatus"><span class="">Process Execution Status </span></h2>
  <p>To have the history of process execution, click the "Status" button when a service is selected, or select one instance of the service. Each line of the status window gives the user the status of the process (ended, fail, warning or running), the start date, the end date and details. The list of tasks execution can be accessed by clicking on the details icon on the right.</p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceInstanceStatus.png" width="800"/></a></p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceInstanceStatus2.png" width="800"/></a></p>
  <h2 id="WorkflowDesignandUse-Archiving"><span class="">Archiving </span></h2>
  <p>Each execution of a delete process moves the service instance to an archived list. Then, the service instance is not longer visible from the service tree instance. To list all services instances for a specific service, first select a service and then click on the trash icon on the right. A window appears and shows the last 20 service instances marked as archived. For each instance, the last process executed is listed with the status. Then, the user can:</p>
  <ul>
    <li><strong>Delete</strong> a specific service instance by clicking on the trash icon.</li>
    <li><strong>Restore</strong> a specific service instance. The instance will be displayed on the initial service tree of the console.</li>
    <li><strong>Delete all</strong> service instances for this service. All instances stored into the database will be removed.</li>
  </ul>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceInstanceArchived.png" width="800"/></a></p>
  <h2 id="WorkflowDesignandUse-Dashboard"><span class="">Dashboard </span></h2>
  <p>When you logged into the service management console, the first view is the dashboard. The dashboard shows you 2 levels of information:</p>
  <ul>
    <li><strong>Service status</strong>: This chart represents the repartition of processes for each service. Each line represents a service and each color the number of processes in the same states. Pass your mouse over the status to have the exact number of processes in the same states. Click on the status to open the status window filtered by the status clicked.</li>
  </ul>
  <ul>
    <li><strong>Last 10 processes</strong>: This chart lists the last 10 processes executed or in execution for all of the customer's services. The color of each process points to the status of the process (running, ended, fail or warning). A tool tip shows process information and displays the associated service name, the start and end dates, the duration, and the process ID. By clicking on the status, the users can have the detail of execution of the process.</li>
  </ul>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceDashboard.png" width="800"/></a></p>
  <h2 id="WorkflowDesignandUse-Editors(CreateorUpdateaWorkflow)"><span class="">Editors (Create or Update a Workflow) </span></h2>
  <p>A Workflow can be edited by going to the service management page (first, customer page, then tab "Workflow").</p>
  <p>The creation of a Workflow has to be done directly in the Workflow section of the repository: create a new file directly under Workflow or in a sub-folder, and set its extension to XML (instead of the default PHP).</p>
  <p>The service editor provides a web-based graphical tool to create or modify a service.</p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Service_configuration.png" width="800"/></a></p>
  <p> </p>
  <h3 id="WorkflowDesignandUse-Serviceeditor"><span class="">Service editor </span></h3>
  <p>To open a service file, right click on it and click "Edit definition".</p>
  <p>The following sections are available:</p>
  <ul>
    <li><strong>The PLUS Tab</strong>: Create a new process.</li>
  </ul>
  <ul>
    <li><strong>INFORMATION</strong> : Display administrative information for the service. The user can:
      <ul>
        <li>Select an <strong>icon</strong> from the library. This icon will be displayed in the tree in the service console.</li>
        <li>Set a <strong>display name</strong>. This display name will be used in the service console in the tree, in the dashboard, and as title for status windows.</li>
        <li>Set a <strong>description</strong> as a tooltip in the services tree in the console.</li>
        <li>Set a <strong>category</strong>. The category is a folder to sort services in the console tree on the left. A hierarchy can be created by using "|" between each folder name.</li>
        <li>Set a <strong>service name variable</strong>. The service name variable matches "service_id" by default, otherwise one of the defined variables is used as a name for each service instance created on the tree, to the right of the status icon.</li>
        <li>Define the <strong>rank in category</strong>. Sorts local and global services on the console tree.</li>
        <li>Select the <strong>visibility of the service</strong>. Depending to the user role, a service can be displayed or not.</li>
      </ul>
    </li>
  </ul>
  <ul>
    <li><strong>VARIABLES</strong> : Shows variables or parameters used during process execution. All variables are sent to a process during the execution.
      <ul>
        <li><img alt="ServiceAddIcon.png" height="16" src="images/ServiceAddIcon.png"/> : Add a new variable.</li>
        <li><img alt="ServiceDeleteIcon.png" height="16" src="images/ServiceDeleteIcon.png"/> : Delete a variable after selection.</li>
        <li><img alt="ServiceVarUpIcon.png" height="16" src="images/ServiceVarUpIcon.png"/> : Move up a variable. Drag and drop can be used to sort variable.</li>
        <li><img alt="ServiceVarDownIcon.png" height="16" src="images/ServiceVarDownIcon.png"/> : Move down a variable. Drag and drop can be used to sort variable.</li>
        <li><img alt="ServiceVarPlayIcon.png" height="16" src="images/ServiceVarPlayIcon.png"/> : Preview variable header displayed on the center of the console.</li>
        <li><img alt="ServiceVarExtractIcon.png" height="16" src="images/ServiceVarExtractIcon.png"/> : Extract variable from process definition files.</li>
      </ul>
    </li>
  </ul>
  <ul>
    <li>'Variable customization':</li>
  </ul>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Variablecustomization.png" width="800"/></a></p>
  <p>Similarly to the OBMF/Microservice framework you can also configure variable parameters:</p>
  <ul>
    <li>their visibility</li>
    <li>their type</li>
    <li>their order</li>
    <li>their display name</li>
    <li>their default value</li>
    <li>their access right (read only/read-write)</li>
    <li>their delegation level (administrator/customer)</li>
  </ul>
  <ul>
    <li><strong>PROCESS</strong>: All tabs after the information and variable tabs are processes. For each process, a user can define the type of the process (CRUD), the display name and the level of visibility. A diagram shows the order of task executions. You can change the order of the tasks by using the drag and drop feature.
      <ul>
        <li>Select the <strong>type of the process</strong> (CREATE, CREATE (if required), READ, UPDATE, DELETE). Depending on the actions defined in your process, the type permits you to manage the instance in the console. For example, if you select the service ni the tree, only processes typed as CREATE will be available. If you select an existing instance, you will have  processes available to update or delete this specific instance. <strong>Note</strong>: The <strong>CREATE (if required) or update</strong> is only useful for scheduling. Thanks to this, you can create a service instance and update it using only one process instead of using two different ones. In short, <strong>the create will become an update after being executed</strong>.</li>
        <li>Set a <strong>display name</strong>.</li>
        <li>Set the <strong>visibility</strong>. Depending to the role of the user, this process will be available or not. Associated status of for each instances of this process will be filtered also.</li>
        <li><img alt="ServiceAddIcon.png" height="16" src="images/ServiceAddIcon.png"/> : Add a new task as a step of the current process. A name should be provided inside the blue box.</li>
        <li><img alt="ServiceBrowseIcon.png" height="16" src="images/ServiceBrowseIcon.png"/> : Select a task from the repository.</li>
        <li><img alt="ServiceCreateIcon.png" height="16" src="images/ServiceCreateIcon.png"/> : Create a new task file. The new task will be created under Process/&lt;Service_Name&gt;/Tasks in the repository.</li>
        <li><img alt="ServiceEditIcon.png" height="16" src="images/ServiceEditIcon.png"/> : Edit the task.</li>
        <li><img alt="ServiceDeleteIcon.png" height="16" src="images/ServiceDeleteIcon.png"/> : Delete the task.</li>
      </ul>
    </li>
  </ul>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/ServiceEditor.png" width="800"/></a></p>
  <p> </p>
  <p><em>On the screenshot below, there are 3 processes in "my VNF service": Create VNF, Delete VNF and Update VNF</em>. My delete process is marked as delete process. The display name is Delete VNF and the minimum role to see the process is Administrator<em>.</em></p>
  <ul>
    <li><strong>PROCESS popup design</strong>: when a process is started MSA executes a set of different PHP tasks. When designing the process you want to expose a set of variables. For that purpose you must:
      <ul>
        <li>declare and customize them in the variables tab (see below section)</li>
        <li>declare them in each PHP task they are requiredin.</li>
      </ul>
    </li>
  </ul>
  <p>A service can include further different processes and contain lot of variables. For ergonomic reasons, a process popup will expose only variables that will be declared in both the service variables list and PHP tasks.</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Variabletaskdeclaration.png" width="800"/></a></p>
  <p> </p>
  <p><strong>Example</strong>: Here is a service that includes about 10 variables (username/device/password/role/...). All of them will be exposed when triggering the creation process.</p>
   <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Createpopup.png" width="800"/></a></p>
  <p> Only the username will be displayed when executing the retry process. See popup in screenshot:</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Retrypopup.png" width="800"/></a></p>
  <h3 id="WorkflowDesignandUse-Authorization"><span class="">Authorization </span></h3>
  <p>The service orchestration provides a simple service authorization mechanism applicable independently to each service’s process, based on the connected user role.</p>
  <p>It is therefore possible, for a given service to give an execution authorization to a simple manager (or above), and for another process of the same service to give the execution authorization to a privileged manager (or above).</p>
  <p><a class="image-popup-fit-width" href="">
    <img alt="Image" src="images/Process_auth_level.png" width="455px"/></a></p>
  <p> </p>
  <p> </p>
</div>



        </div>