= Version 2.6
ifndef::imagesdir[:imagesdir: images]
ifdef::env-github,env-browser[:outfilesuffix: .adoc]

This release is mainly a feature enhancement and bug fix release. 

This includes a few changes related to the architecture such as adding a new container dedicated to the monitoring of the managed entities, upgrading Kibana to a more recent version or replacing Wildfly by Spring Boot for the REST API.

Alarm performances are now better with a very short delay between collecting the logs and triggering the alarm action.

This release also includes some manager and developer functionality enhancements such as a live filtering for the Kibana dashboard, a new variable type for the Microservices or additional functions in the Python SDK for developing Workflows.

== Manager Features

=== BPM 

Changing the display name of a BPM is now possible as well as providing a custom identifier for the BPM instance. 

=== Alarm Performance

Improved performances allow to reduce the alarm aggregation time, reducing the delay between the collection of the event by the CoreEngine and the detection of an alarm.

=== Manager Dashboard and Kibana Dashboard

A live filtering mechanism has been added to the manager dashboard when a Kibana dashboard has to be displayed. 
This mechanism makes sure that the data displayed by the Kibana dashboard is filtered based on the selected subtenant.

In addition, when using "Save as Global Setting" the super administrator user can configure a custom manager dashboard that will be visible by all other users.
Any other user with enough privileges can over overwrite the global setting of the dashboard and create its own custom dashboard.

=== Download Monitoring Graphs

For each managed entity, it is now possible to download each monitoring graph as an PNG image file.

== Developer Features

=== Workflow Python SDK Update

A few new functions have been added to the Workflow SDK for Python developer.

The new module ConfBackup provides a set of functions useful backing up and restoring the configuration of a managed entity.

The module Device has also been updated with a new function `run_jsa_command_device` to execute adapter commands.

=== Microservice Variable Type "Unique Value"

To make sure that, for each instance of a microservice associated to a managed entity, a variable typed as "Unique Value" can only be assigned with a value that has not been used yet.

== Admin and Settings

=== License Expiration Information

When a license is about to expire, the super admin user ncroot will get notified in the web portal and will also receive an email. 
This notification will happen when the expiration date is in less that 7 days than the current date.

image:2.6_license_status.png[]

=== Enhanced Help Global Setting

{product_name} variable in the global setting have been reviewed to make sure that each variable description is as clear as possible. 

=== Upgrade Script

The product upgrade script now stops and exits when a merge conflict is detected during the installation or upgrade of the libraries. 
The user will then be able to manually resolve the conflict by connecting to the msa_dev container and use git commands.

Once all conflicts are resolved, the script can be executed again.

== Architecture

Several parts of the {product_name} have been upgraded to enhance the performances as well as the flexibility of the product.

The API container now runs Spring Boot, replacing Wildfly. 
This provides a simpler, lighter and more efficient container.

The Kibana container has been upgraded from version 7.2 to version 7.13.

A new monitoring container, msa_monitoring, has been added. 
This container is dedicated to KPI monitoring features that were included in the msa_sms container in the previous versions.

== CoreEngine

No changes have been made to the core engine from previous versions of the product. This allows consistency from branches of OpenMSA (community version), found on GitHub: https://github.com/openmsa

== New Libraries Available

=== Adapters

== Upgrading

Instructions to upgrade available in the quickstart guide.

=== Specific instructions for upgrading from {revnumber-prev} to {revnumber}

Starting from version 2.2.0, the quickstart provides an upgrade script `upgrade.sh` for taking care of possible actions such as recreating some volume, executing some database specific updates,...

Let's say that you are running {product_name} version {revnumber-prev}, to upgrade to the version {revnumber}, you need to follow these steps:

1. `cd quickstart`
2. `git checkout master`
3. `git fetch --unshallow`
4. `git pull`
5. `./scripts/install.sh`

=== only from 2.4.x or earlier

1. `docker-compose exec msa_front /bin/sh -c 'chown -R nginx:nginx /etc/ssl'`

== Specific technical fixes and feature details

=== 2.6.0 GA

==== Features
* MSA-10507 - [Adapter] Linux Generic implement support for "Do execute command"
* MSA-8999 - [Admin] Manager must be informed of license expiration
* MSA-9514 - [AI/ML] Description of States and Actions in Tooltip
* MSA-9910 - [Alarm] remove error warning when name format is corrected
* MSA-10374 - [Alarm] Test short cyclic run of check_alert without any delay in getting logs
* MSA-9797 - [Architecture] Move sms_polld in a separate container
* MSA-10436 - [BPM] Store subtenant in the camunda engine
* MSA-10494 - [BPM] Take input parameters on BPM execute API
* MSA-10410 - [BPM] displayName should be returned by repository file GET endpoint
* MSA-10411 - [BPM] Possibility to rename BPM
* MSA-10449 - [BPM] Show (friendly) user instance name
* MSA-9911 - [Dashboard] enhancement suggestions for manager dashboard customization
* MSA-10091 - [Dashboard] Dashboard Live Filtering mechanism
* MSA-10128 - [Infrastructure Discovery] New Workflow
* MSA-10453 - [Kibana] Update from Kibana v7.2 to 7.13
* MSA-10349 - [Managed Entity] Download Monitoring graphs as image files
* MSA-10355 - [Managed Entity] API to get an Interface
* MSA-10430 - [Managed Entity] Return total subtenant count in device v1
* MSA-10431 - [Managed Entity] Show correct total subtenant count on Dashboard
* MSA-10249 - [Microservice] Add Index type variable
* MSA-10441 - [Microservice] Save Constraint only when there is existing tag
* MSA-10256 - [Portal] Review Description and Help of MSA Vars
* MSA-10173 - [Python SDK] Create 'Backup Configuration' in the Device library
* MSA-10262 - [Python SDK] Create method to 'Do execute command by managed entity id'
* MSA-10263 - [Python SDK] Create method to 'Sends jsa command to a device'
* MSA-10437 - [Settings] Save as global settings
* MSA-10398 - [Upgrade] Block upgrade script to block if there are merge issue on library installation
* MSA-10406 - [Workflow] Review mandatory parameters for schedule API
* MSA-8629 - [Workflow] Replace the read of /opt/configurator/vars.ubiqube.net.ctx in workflows
* MSA-10363 - [Workflow] Show user friendly running time
* MSA-10371 - [Workflow] Control Visibility for Task in Repository for Manager

==== Bug fixes
* MSA-10334 - [Admin] the date is not updated when Permission is updated
* MSA-6464 - [Alarm] Alert emails body lines more than 40 chars disturb the mail
* MSA-10443 - [Alarm] Workflow are triggered long time after an alarm is raised - Timestamp not cleaned
* MSA-10376 - [Alarms] Remove not used parameters in search logs and search alarms
* MSA-10447 - [API] in MSA V2.5 or later, bad answers for device/ping
* MSA-10461 - [Assurance] Syslogs are no more parsed and so not stored in ES
* MSA-9497 - [Assurance] attaching Monitoring profile to Managed Entity is not consistent with other attachment UX
* MSA-9744 - [Assurance] default traffic graph should not be displayed if there is no management interface configured for the Managed Entity
* MSA-9608 - [Assurance] Displayed raw logs are incomplete
* MSA-10166 - [Assurance] Traffic analysis in Standard graph profile showing high peaks data on Custom portal
* MSA-10362 - [Assurance] wrong message "The selected monitoring profile doesn't have any graphical rendering defined" when a profile is selected to display the graph
* MSA-10444 - [Backend] Configuration variables not read properly by msa_sms, msa_bud, msa_alarm, msa_monitoring
* MSA-10486 - [Backend] Errors updating RRD files due to more than one polling thread per Managed Entity
* MSA-10495 - [BPM] API that gets status of BPM is not working
* MSA-10341 - [BPM] adapt end date in case of scheduling more than once
* MSA-9987 - [BPM] execution time display is inconsistent for BPM and executed Workflow
* MSA-10415 - [CoreEngine] When UBI_SMS_TINY_SYSLOGS is set to 1 the script /opt/sms/etc/stop.sh is stuck
* MSA-10044 - [Dashboard] in Managed Entity component, filter by status not working when subtenant selected in banner
* MSA-9815 - [Database] Use only one interface name in database for the management interface name
* MSA-10340 - [License] Manager must be informed of license expiration
* MSA-9995 - [Managed Entity] action buttons in History tab have inconsistent naming/tooltips
* MSA-10457 - [Microservice] type microservice reference doesn't filter the list of MS based on vendor/model
* MSA-10152 - [Microservice] remove the Import which is triggered as part of the CRUD commands and always ends in error
* MSA-9559 - [Microservice] in user form, the input field display names are not fully visible when a value in entered
* MSA-10364 - [Microservice] Filter Deployment Settings by Subtenant
* MSA-10365 - [Microservice] Filter Deployment Settings by Subtenant
* MSA-10423 - [Microservice] Missing the mandatory variable 'array.0.element' in JSON parameters - Bad parameters on command
* MSA-10418 - [Microservice] missing field label when a variable is read-only
* MSA-9582 - [Microservice/Workflow] In some cases composite variable cannot use a free value as selector value
* MSA-10180 - [Portal] after an upgrade from 2.4 to 2.5, custom certificate in msa_front are not readable anymore
* MSA-9919 - [Python SDK] OSError: Could not find a suitable TLS CA certificate bundle, invalid path
* MSA-10414 - [Security] New vulnerabilities detected in 2.6 RC1
* MSA-8588 - [Security] Directory traversal in /repository/v1/repository-content
* MSA-8590 - [Security] Directory traversal in /repository/files
* MSA-8591 - [Security] Directory traversal in /repository/v1/properties-file
* MSA-8592 - [Security] Directory traversal in /ubi-api-rest/repository/v1/file-content
* MSA-8593 - [Security] Arbitrary file creation thru directory traversal in /repository/v1/file
* MSA-9331 - [Topology] display times out if the topology Workflow takes to much time to execute
* MSA-10149 - [UI] The refreshment of the operation screen is too slow after executing each process in workflow.
* MSA-10258 - [UI] Bad regexp to validate a few configuration variables
* MSA-10348 - [Workflow] Restrict execution of more than one process of service instance at same time
* MSA-10419 - [Workflow] Workflow failed because of "message": "Bad parameters on command: Missing the mandatory variable", even if the variable i not mandatory
* MSA-10426 - [Workflow] reused task error at execution
* MSA-10433 - [workflows] workflow count when filter is used : display not correct
* MSA-10452 - [Workflow] running process (with no schedule ) appears in scheduled tab instead of instances tab
* MSA-9485 - [Workflow] the total number of workflows is not consistent
* MSA-9915 - [Workflows] in attachment dialog window, search filter is too much permissive (use special characters)
